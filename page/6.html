<!doctype html><html lang=zh-CN><head><meta name=generator content="Hugo 0.121.2"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="逃避虽然可耻但有用"><meta property="og:site_name" content="逃避虽然可耻但有用"><meta property="og:locale" content="zh-CN"><meta property="article:published_time" content="0001-01-01T00:00:00+0000"><meta property="article:modified_time" content="2024-01-10T22:26:31+0800"><title>逃避虽然可耻但有用</title><link rel=alternate type=application/rss+xml href=/atom.xml title=逃避虽然可耻但有用>
<link rel=stylesheet href=/css/fika.min.2121d323520ffc9463fd9137fc47ffccf72099f83ce40f24c3f32f2cae5ff47f.css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon></head><body><header><div><div id=imglogo><a href=https://www.leelib.com/><img src=/img/logo.webp alt=逃避虽然可耻但有用 title=逃避虽然可耻但有用></a></div><div id=textlogo><h1 class=site-name><a href=/ title=逃避虽然可耻但有用>逃避虽然可耻但有用</a></h1><h2 class=blog-motto>少壮不努力，一生在内地</h2></div><nav class=animated><ul><li><a href=/>主页</a></li><li><a href=/archives/index.html>归档</a></li><li><a href=/about/index.html>关于</a></li><li><a href=/disappear/index.html>消失</a></li></ul></nav></div></header><div id=container><div id=main><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/09/06/sk-buff-2-6-18-diff-2-6-33.html title=结构体sk_buff在Linux内核2.6.18与2.6.33中的区别 itemprop=url>结构体sk_buff在Linux内核2.6.18与2.6.33中的区别</a></h1><p class=article-time><time datetime="2013-09-06 17:28:58 +0800 +0800" itemprop=datePublished>2013-09-06</time></p></header><div class=article-content><p>在Linux 2.6.33.6中，源文件在：/usr/src/kernels/2.6.33.6/include/linux/skbuff.h</p><h1 id=struct-sk_buff在2618中的定义>struct sk_buff在2.6.18中的定义：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sk_buff {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These two members must be first. */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>prev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sock             <span style=color:#f92672>*</span>sk;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> skb_timeval      tstamp;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> net_device       <span style=color:#f92672>*</span>dev;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> net_device       <span style=color:#f92672>*</span>input_dev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> tcphdr   <span style=color:#f92672>*</span>th;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> udphdr   <span style=color:#f92672>*</span>uh;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> icmphdr  <span style=color:#f92672>*</span>icmph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> igmphdr  <span style=color:#f92672>*</span>igmph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> iphdr    <span style=color:#f92672>*</span>ipiph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> ipv6hdr  <span style=color:#f92672>*</span>ipv6h;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>   <span style=color:#f92672>*</span>raw;
</span></span><span style=display:flex><span>        } h;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> iphdr    <span style=color:#f92672>*</span>iph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> ipv6hdr  <span style=color:#f92672>*</span>ipv6h;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> arphdr   <span style=color:#f92672>*</span>arph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>   <span style=color:#f92672>*</span>raw;
</span></span><span style=display:flex><span>        } nh;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>   <span style=color:#f92672>*</span>raw;
</span></span><span style=display:flex><span>        } mac;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span>  dst_entry       <span style=color:#f92672>*</span>dst;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span>  sec_path        <span style=color:#f92672>*</span>sp;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * This is the control buffer. It is free to use for every
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * layer. Please put your private variables there. If you
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * want to keep them across layers you have to do a skb_clone()
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * first. This is owned by whoever has the skb queued ATM.
</span></span></span><span style=display:flex><span><span style=color:#75715e>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span>                    cb[<span style=color:#ae81ff>48</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            len,
</span></span><span style=display:flex><span>                                data_len,
</span></span><span style=display:flex><span>                                mac_len,
</span></span><span style=display:flex><span>                                csum;
</span></span><span style=display:flex><span>        __u32                   priority;
</span></span><span style=display:flex><span>        __u8                    local_df:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                cloned:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                ip_summed:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                                nohdr:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                nfctinfo:<span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        __u8                    pkt_type:<span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>                                fclone:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span><span style=color:#75715e>#ifndef CONFIG_XEN
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                ipvs_property:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#else
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                ipvs_property:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                proto_data_valid:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                proto_csum_blank:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __be16                  protocol;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span>                    (<span style=color:#f92672>*</span>destructor)(<span style=color:#66d9ef>struct</span> sk_buff <span style=color:#f92672>*</span>skb);
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NETFILTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_conntrack     <span style=color:#f92672>*</span>nfct;
</span></span><span style=display:flex><span><span style=color:#75715e>#if defined(CONFIG_NF_CONNTRACK) || defined(CONFIG_NF_CONNTRACK_MODULE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>nfct_reasm;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_BRIDGE_NETFILTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_bridge_info   <span style=color:#f92672>*</span>nf_bridge;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u32                   nfmark;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif </span><span style=color:#75715e>/* CONFIG_NETFILTER */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_SCHED
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_index;       <span style=color:#75715e>/* traffic control index */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_CLS_ACT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_verd;        <span style=color:#75715e>/* traffic control verdict */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_DMA
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>dma_cookie_t</span>            dma_cookie;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NETWORK_SECMARK
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u32                   secmark;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These elements must be at the end, see alloc_skb() for details.  */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            truesize;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>atomic_t</span>                users;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>           <span style=color:#f92672>*</span>head,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>data,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>tail,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>end;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* Extra stuff at the end to avoid breaking abi */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifndef __GENKSYMS__
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span>                      peeked;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span></code></pre></div><h1 id=struct-sk_buff在2633中的定义>struct sk_buff在2.6.33中的定义：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sk_buff {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These two members must be first. */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>prev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>ktime_t</span>                 tstamp;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sock             <span style=color:#f92672>*</span>sk;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> net_device       <span style=color:#f92672>*</span>dev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * This is the control buffer. It is free to use for every
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * layer. Please put your private variables there. If you
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * want to keep them across layers you have to do a skb_clone()
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * first. This is owned by whoever has the skb queued ATM.
</span></span></span><span style=display:flex><span><span style=color:#75715e>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span>                    cb[<span style=color:#ae81ff>48</span>] <span style=color:#a6e22e>__aligned</span>(<span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span>           _skb_dst;
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_XFRM
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span>  sec_path        <span style=color:#f92672>*</span>sp;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            len,
</span></span><span style=display:flex><span>                                data_len;
</span></span><span style=display:flex><span>        __u16                   mac_len,
</span></span><span style=display:flex><span>                                hdr_len;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                __wsum          csum;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>                        __u16   csum_start;
</span></span><span style=display:flex><span>                        __u16   csum_offset;
</span></span><span style=display:flex><span>                };
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        __u32                   priority;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kmemcheck_bitfield_begin</span>(flags1);
</span></span><span style=display:flex><span>        __u8                    local_df:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                cloned:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                ip_summed:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                                nohdr:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                nfctinfo:<span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        __u8                    pkt_type:<span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>                                fclone:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                                ipvs_property:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                peeked:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                nf_trace:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        __be16                  protocol:<span style=color:#ae81ff>16</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kmemcheck_bitfield_end</span>(flags1);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span>                    (<span style=color:#f92672>*</span>destructor)(<span style=color:#66d9ef>struct</span> sk_buff <span style=color:#f92672>*</span>skb);
</span></span><span style=display:flex><span><span style=color:#75715e>#if defined(CONFIG_NF_CONNTRACK) || defined(CONFIG_NF_CONNTRACK_MODULE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_conntrack     <span style=color:#f92672>*</span>nfct;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>nfct_reasm;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_BRIDGE_NETFILTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_bridge_info   <span style=color:#f92672>*</span>nf_bridge;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span>                     skb_iif;
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_SCHED
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_index;       <span style=color:#75715e>/* traffic control index */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_CLS_ACT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_verd;        <span style=color:#75715e>/* traffic control verdict */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kmemcheck_bitfield_begin</span>(flags2);
</span></span><span style=display:flex><span>        __u16                   queue_mapping:<span style=color:#ae81ff>16</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_IPV6_NDISC_NODETYPE
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u8                    ndisc_nodetype:<span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>kmemcheck_bitfield_end</span>(flags2);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* 0/14 bit hole */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_DMA
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>dma_cookie_t</span>            dma_cookie;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NETWORK_SECMARK
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u32                   secmark;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                __u32           mark;
</span></span><span style=display:flex><span>                __u32           dropcount;
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        __u16                   vlan_tci;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          transport_header;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          network_header;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          mac_header;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These elements must be at the end, see alloc_skb() for details.  */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          tail;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          end;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>           <span style=color:#f92672>*</span>head,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>data;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            truesize;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>atomic_t</span>                users;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>有了以上定义的话，我们就可以做类似如下定义来使我们的驱动支持多内核了：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sk_buff <span style=color:#f92672>*</span>new_skb;
</span></span><span style=display:flex><span><span style=color:#75715e>#if LINUX_VERSION_CODE &lt;= KERNEL_VERSION(2,6,18)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>new_skb<span style=color:#f92672>-&gt;</span>mac.raw <span style=color:#f92672>=</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)new_eth_p;
</span></span><span style=display:flex><span><span style=color:#75715e>#else
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>new_skb<span style=color:#f92672>-&gt;</span>mac_header <span style=color:#f92672>=</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)new_eth_p;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span></code></pre></div><p>参考：<a href=http://www.linuxquestions.org/questions/linux-kernel-70/struct-sk_buff-differs-in-2-6-18-and-2-6-33-kernel-882507/>http://www.linuxquestions.org/questions/linux-kernel-70/struct-sk_buff-differs-in-2-6-18-and-2-6-33-kernel-882507/</a></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>linux</a></div><div class=article-tags><span></span>
<a href=/tags/driver.html>Driver</a>
<a href=/tags/inux_version_code.html>INUX_VERSION_CODE</a>
<a href=/tags/kernel.html>kernel</a>
<a href=/tags/kernel_version.html>KERNEL_VERSION</a>
<a href=/tags/linux.html>linux</a>
<a href=/tags/sk_buff.html>sk_buff</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/07/26/fix-centos-yum.html title=解决CentOS安装新版本python后，yum不能使用的问题 itemprop=url>解决CentOS安装新版本python后，yum不能使用的问题</a></h1><p class=article-time><time datetime="2013-07-26 02:42:41 +0800 +0800" itemprop=datePublished>2013-07-26</time></p></header><div class=article-content><h1 id=centos-上安装新版本-python>CentOS 上安装新版本 python</h1><p>请看： <a href=/2013/07/10/fix-python-deff-version.html>安装python以及解决版本问题</a></p><p>但在安装新版本后，yum不能正常使用了。原因是yum是基于默认的python版本运行的，例如CentOS6.2基于python2.6。但我们安装版本后建立了链接，覆盖掉了默认python调用，导致yum脚本无法正常调用到自己想要的版本。</p><h1 id=解决方案>解决方案</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim /usr/bin/yum
</span></span></code></pre></div><p>将第一行 <strong>#!/usr/bin/python</strong> 修改成 <strong>#!/usr/bin/python2.6</strong></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>linux</a></div><div class=article-tags><span></span></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/07/10/gnu-stubs-64-h-no-such-file-or-directory.html title="解决编译时出现“gnu/stubs-64.h: No such file or directory”的问题" itemprop=url>解决编译时出现“gnu/stubs-64.h: No such file or directory”的问题</a></h1><p class=article-time><time datetime="2013-07-10 10:12:49 +0800 +0800" itemprop=datePublished>2013-07-10</time></p></header><div class=article-content><h1 id=这个实际上是系统没有安装-glibc-开发包的问题>这个实际上是系统没有安装 <strong>glibc</strong> 开发包的问题</h1><h2 id=ubuntu-x64>Ubuntu x64</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install libc6-dev-amd64
</span></span></code></pre></div><h2 id=centos-x64>CentOS x64</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install glibc-devel.x86_64
</span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>linux</a></div><div class=article-tags><span></span>
<a href=/tags/centos.html>centos</a>
<a href=/tags/glibc.html>glibc</a>
<a href=/tags/gnu.html>gnu</a>
<a href=/tags/libc.html>libc</a>
<a href=/tags/make.html>make</a>
<a href=/tags/stubs.html>stubs</a>
<a href=/tags/ubuntu.html>ubuntu</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/07/10/fix-python-deff-version.html title=如何安装新版本python，以及解决安装了新版python后，默认python依然调用旧版本的问题 itemprop=url>如何安装新版本python，以及解决安装了新版python后，默认python依然调用旧版本的问题</a></h1><p class=article-time><time datetime="2013-07-10 06:27:35 +0800 +0800" itemprop=datePublished>2013-07-10</time></p></header><div class=article-content><h1 id=安装新版本python>安装新版本python</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://python.org/ftp/python/2.7.3/Python-2.7.3.tar.bz2
</span></span><span style=display:flex><span>tar xjf Python-2.7.3.tar.bz2
</span></span><span style=display:flex><span>cd Python-2.7.3
</span></span><span style=display:flex><span>./configure
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make atlinstall
</span></span></code></pre></div><p>这时 python2.7.3 版本已经安装成功了。
但调用 <strong>python &ndash;version</strong> 依然会显示并使用旧版本</p><h1 id=解决办法就是重新建立一个链接并覆盖掉旧的>解决办法就是重新建立一个链接并覆盖掉旧的</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ln -s /usr/local/bin/python2.7 /usr/bin/python -f
</span></span></code></pre></div><p>再调用 <strong>python &ndash;version</strong> 显示结果</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos<span style=color:#f92672>]</span><span style=color:#75715e># python --version</span>
</span></span><span style=display:flex><span>Python 2.7.3
</span></span></code></pre></div><p>至此，问题解决 :)</p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>linux</a></div><div class=article-tags><span></span>
<a href=/tags/atlinstall.html>atlinstall</a>
<a href=/tags/configure.html>configure</a>
<a href=/tags/install.html>install</a>
<a href=/tags/ln.html>ln</a>
<a href=/tags/make.html>make</a>
<a href=/tags/python.html>python</a>
<a href=/tags/wget.html>wget</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/07/02/python-zlib-trans-c.html title=python的zlib压缩解压缩对应的C语言方式 itemprop=url>python的zlib压缩解压缩对应的C语言方式</a></h1><p class=article-time><time datetime="2013-07-02 15:47:00 +0800 +0800" itemprop=datePublished>2013-07-02</time></p></header><div class=article-content><h1 id=压缩>压缩</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>enData <span style=color:#f92672>=</span> zlib<span style=color:#f92672>.</span>compress(data)[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>]
</span></span></code></pre></div><p>对应：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#a6e22e>compress2</span>(dstbuf, <span style=color:#f92672>&amp;</span>dstLen, strSrc, srcLen, <span style=color:#ae81ff>6</span>);
</span></span></code></pre></div><h1 id=解压>解压</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>deData <span style=color:#f92672>=</span> zlib<span style=color:#f92672>.</span>decompress(enData, <span style=color:#f92672>-</span>zlib<span style=color:#f92672>.</span>MAX_WBITS)
</span></span></code></pre></div><p>对应：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>gzipInflate</span>( <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string<span style=color:#f92672>&amp;</span> compressedBytes, std<span style=color:#f92672>::</span>string<span style=color:#f92672>&amp;</span> uncompressedBytes ) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ( compressedBytes.<span style=color:#a6e22e>size</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> ) {
</span></span><span style=display:flex><span>        uncompressedBytes <span style=color:#f92672>=</span> compressedBytes ;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> true ;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    uncompressedBytes.<span style=color:#a6e22e>clear</span>() ;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> full_length <span style=color:#f92672>=</span> compressedBytes.<span style=color:#a6e22e>size</span>() ;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> half_length <span style=color:#f92672>=</span> compressedBytes.<span style=color:#a6e22e>size</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> uncompLength <span style=color:#f92672>=</span> full_length ;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> uncomp <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>) <span style=color:#a6e22e>calloc</span>( <span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>char</span>), uncompLength );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    z_stream strm;
</span></span><span style=display:flex><span>    strm.next_in <span style=color:#f92672>=</span> (Bytef <span style=color:#f92672>*</span>) compressedBytes.<span style=color:#a6e22e>c_str</span>();
</span></span><span style=display:flex><span>    strm.avail_in <span style=color:#f92672>=</span> compressedBytes.<span style=color:#a6e22e>size</span>() ;
</span></span><span style=display:flex><span>    strm.total_out <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    strm.zalloc <span style=color:#f92672>=</span> Z_NULL;
</span></span><span style=display:flex><span>    strm.zfree <span style=color:#f92672>=</span> Z_NULL;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>bool</span> done <span style=color:#f92672>=</span> false ;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//if (inflateInit2(&amp;strm, (16+MAX_WBITS)) != Z_OK)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>inflateInit2</span>(<span style=color:#f92672>&amp;</span>strm, <span style=color:#f92672>-</span>MAX_WBITS) <span style=color:#f92672>!=</span> Z_OK)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>free</span>( uncomp );
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span>done) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If our output buffer is too small
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (strm.total_out <span style=color:#f92672>&gt;=</span> uncompLength ) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Increase size of output buffer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> uncomp2 <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>) <span style=color:#a6e22e>calloc</span>( <span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>char</span>), uncompLength <span style=color:#f92672>+</span> half_length );
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>memcpy</span>( uncomp2, uncomp, uncompLength );
</span></span><span style=display:flex><span>            uncompLength <span style=color:#f92672>+=</span> half_length ;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>free</span>( uncomp );
</span></span><span style=display:flex><span>            uncomp <span style=color:#f92672>=</span> uncomp2 ;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        strm.next_out <span style=color:#f92672>=</span> (Bytef <span style=color:#f92672>*</span>) (uncomp <span style=color:#f92672>+</span> strm.total_out);
</span></span><span style=display:flex><span>        strm.avail_out <span style=color:#f92672>=</span> uncompLength <span style=color:#f92672>-</span> strm.total_out;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Inflate another chunk.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span> err <span style=color:#f92672>=</span> <span style=color:#a6e22e>inflate</span> (<span style=color:#f92672>&amp;</span>strm, Z_SYNC_FLUSH);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (err <span style=color:#f92672>==</span> Z_STREAM_END) done <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (err <span style=color:#f92672>!=</span> Z_OK)  {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>inflateEnd</span> (<span style=color:#f92672>&amp;</span>strm) <span style=color:#f92672>!=</span> Z_OK) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>free</span>( uncomp );
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ( <span style=color:#66d9ef>size_t</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>strm.total_out; <span style=color:#f92672>++</span>i ) {
</span></span><span style=display:flex><span>        uncompressedBytes <span style=color:#f92672>+=</span> uncomp[ i ];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>free</span>( uncomp );
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> true ;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>programing</a></div><div class=article-tags><span></span>
<a href=/tags/c.html>c</a>
<a href=/tags/compress.html>compress</a>
<a href=/tags/decompress.html>decompress</a>
<a href=/tags/python.html>python</a>
<a href=/tags/zlib.html>zlib</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/07/01/windows-use-zlib-link-error.html title="Windows下编译使用zlib库的程序时出现“无法解析的外部符号 _compress”解决方案" itemprop=url>Windows下编译使用zlib库的程序时出现“无法解析的外部符号 _compress”解决方案</a></h1><p class=article-time><time datetime="2013-07-01 05:29:47 +0800 +0800" itemprop=datePublished>2013-07-01</time></p></header><div class=article-content><h1 id=错误描述>错误描述</h1><p><strong>error LNK2019: unresolved external symbol _compress referenced</strong></p><h1 id=解决方案>解决方案</h1><p>在 <strong>#include &lt;zlib.h></strong> 之前加上 <strong>#define ZLIB_WINAPI</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#define ZLIB_WINAPI
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;zlib.h&gt;</span><span style=color:#75715e>
</span></span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>programing</a></div><div class=article-tags><span></span>
<a href=/tags/compress.html>compress</a>
<a href=/tags/windows.html>windows</a>
<a href=/tags/zlib.html>zlib</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/06/29/use-zlib-exp.html title=一句话经验zlib itemprop=url>一句话经验zlib</a></h1><p class=article-time><time datetime="2013-06-29 04:27:00 +0800 +0800" itemprop=datePublished>2013-06-29</time></p></header><div class=article-content><p>Linux使用gcc编译使用zlib库的代码时，使用 <strong>-lz</strong> 来链接(link) <strong>zlib</strong> 库。</p><p>否则就会出现类似 <strong>undefined reference to `deflateInit_&rsquo;</strong> 的错误</p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>programing</a></div><div class=article-tags><span></span>
<a href=/tags/gcc.html>gcc</a>
<a href=/tags/linux.html>linux</a>
<a href=/tags/zlib.html>zlib</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/06/08/tcpdump-error.html title="Linux调用tcpdump时“tcpdump: USB link-layer type filtering not implemented”解决方案" itemprop=url>Linux调用tcpdump时“tcpdump: USB link-layer type filtering not implemented”解决方案</a></h1><p class=article-time><time datetime="2013-06-08 03:00:30 +0800 +0800" itemprop=datePublished>2013-06-08</time></p></header><div class=article-content><p>当调用tcpdump时，出现错误：<strong>tcpdump: USB link-layer type filtering not implemented</strong></p><h1 id=原因>原因</h1><p>说明系统可能有多块网卡共存。</p><h1 id=需要指定工作网卡才能开始截包使用参数举例>需要指定工作网卡才能开始截包，使用参数举例</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos<span style=color:#f92672>]</span><span style=color:#75715e># tcpdump -i eth0 udp port 53</span>
</span></span></code></pre></div><p><em>在实际使用中例子中“eth0”“udp”“53”等参数，要根据实际需要来进行修改。</em>
<em>虽然一般单网卡默认名称应该是eth0，但也有其他情况。实际中要使用ifconfig查看自己需要使用的网卡。</em></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>linux</a></div><div class=article-tags><span></span>
<a href=/tags/ifconfig.html>ifconfig</a>
<a href=/tags/linux.html>linux</a>
<a href=/tags/netcap.html>netcap</a>
<a href=/tags/tcpdump.html>tcpdump</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/06/07/gcc-to-gpp-inet-addr-was-not-declared-in-this-scope.html title="gcc迁移到g++出现 inet_addr was not declared in this scope 解决方案" itemprop=url>gcc迁移到g++出现 inet_addr was not declared in this scope 解决方案</a></h1><p class=article-time><time datetime="2013-06-07 14:06:31 +0800 +0800" itemprop=datePublished>2013-06-07</time></p></header><div class=article-content><h1 id=错误原因>错误原因</h1><p>我手上一个项目本身采用gcc编译。后来因为代码功能需要移植到g++中时，出现了 <strong>&ldquo;inet_addr&rdquo; was not declared in this scope</strong> 这个错误。</p><h1 id=解决方案>解决方案</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// 添加该头文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;arpa/inet.h&gt;</span><span style=color:#75715e>
</span></span></span></code></pre></div><h1 id=如果出现下面错误>如果出现下面错误：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>error: string: No such file or directory
</span></span><span style=display:flex><span>error: vector: No such file or directory
</span></span></code></pre></div><ul><li>说明在将g++项目用gcc编译</li></ul></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>programing</a></div><div class=article-tags><span></span>
<a href=/tags/declared.html>declared</a>
<a href=/tags/g++.html>g++</a>
<a href=/tags/gcc.html>gcc</a>
<a href=/tags/inet_addr.html>inet_addr</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/06/02/install-kernel-devel.html title=Linux下编译驱动发现没有内核源码的解决办法 itemprop=url>Linux下编译驱动发现没有内核源码的解决办法</a></h1><p class=article-time><time datetime="2013-06-02 12:25:27 +0800 +0800" itemprop=datePublished>2013-06-02</time></p></header><div class=article-content><h2 id=centos系统>CentOS系统</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install -y kernel-devel
</span></span></code></pre></div><h2 id=ubuntu系统>Ubuntu系统</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install linux-source
</span></span></code></pre></div><p>以上～！</p><blockquote><p>参考：《或许你不需要整个内核的源代码》 - <a href=http://wiki.centos.org/zh/HowTos/I_need_the_Kernel_Source>http://wiki.centos.org/zh/HowTos/I_need_the_Kernel_Source</a></p></blockquote></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>linux</a></div><div class=article-tags><span></span>
<a href=/tags/install.html>install</a>
<a href=/tags/kernel.html>kernel</a>
<a href=/tags/ko.html>ko</a>
<a href=/tags/linux.html>linux</a>
<a href=/tags/yum.html>yum</a></div></div></footer></article><nav id=page-nav class=clearfix><a class="extend first" aria-label=First rel=first role=button href=/><span></span>首页</a>
<a class="extend prev" aria-label=Prev rel=prev role=button href=/page/5.html><span></span>上一页</a>
<span>...</span>
<a class=page-number href=/page/3.html aria-label="Page 3" role=button>3</a>
<a class=page-number href=/page/4.html aria-label="Page 4" role=button>4</a>
<a class=page-number href=/page/5.html aria-label="Page 5" role=button>5</a>
<a class="page-number current" aria-label="Page 6" role=button>6</a>
<a class=page-number href=/page/7.html aria-label="Page 7" role=button>7</a>
<a class=page-number href=/page/8.html aria-label="Page 8" role=button>8</a>
<a class=page-number href=/page/9.html aria-label="Page 9" role=button>9</a>
<a class="extend last" aria-label=Last rel=last role=button href=/page/9.html>尾页<span></span></a>
<a class="extend next" aria-label=Next rel=next role=button href=/page/7.html>下一页<span></span></a></nav></div><div id=asidepart><aside class=clearfix><p class=asidetitle>文章分类</p><div class=categorieslist><ul><li><span class=count>1</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/deploy.html title=deploy>deploy</a></li><li><span class=count>1</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/interesting.html title=interesting>interesting</a></li><li><span class=count>29</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/linux.html title=linux>linux</a></li><li><span class=count>6</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/notices.html title=notices>notices</a></li><li><span class=count>28</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/programing.html title=programing>programing</a></li><li><span class=count>1</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/sites.html title=sites>sites</a></li><li><span class=count>10</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/summarys.html title=summarys>summarys</a></li><li><span class=count>2</span>
<svg aria-label="Directory" aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" data-view-component="true" class="octicon mr-3"><path d="M1.75 1A1.75 1.75.0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75.0 0016 13.25v-8.5A1.75 1.75.0 0014.25 3H7.5a.25.25.0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg><a href=/categories/works.html title=works>works</a></li></ul></div></aside><aside class=clearfix><p class=asidetitle>文章标签</p><div class=tagslist><ul class=clearfix><li><a href=/tags/c.html title=c>c<sup>3</sup></a></li><li><a href=/tags/centos.html title=centos>centos<sup>5</sup></a></li><li><a href=/tags/compress.html title=compress>compress<sup>2</sup></a></li><li><a href=/tags/conf.html title=conf>conf<sup>2</sup></a></li><li><a href=/tags/css.html title=css>css<sup>2</sup></a></li><li><a href=/tags/gcc.html title=gcc>gcc<sup>2</sup></a></li><li><a href=/tags/git.html title=git>git<sup>3</sup></a></li><li><a href=/tags/html.html title=html>html<sup>2</sup></a></li><li><a href=/tags/https.html title=https>https<sup>2</sup></a></li><li><a href=/tags/hugo.html title=hugo>hugo<sup>2</sup></a></li><li><a href=/tags/install.html title=install>install<sup>4</sup></a></li><li><a href=/tags/kernel.html title=kernel>kernel<sup>3</sup></a></li><li><a href=/tags/layout.html title=layout>layout<sup>2</sup></a></li><li><a href=/tags/libc.html title=libc>libc<sup>2</sup></a></li><li><a href=/tags/linux.html title=linux>linux<sup>12</sup></a></li><li><a href=/tags/ln.html title=ln>ln<sup>2</sup></a></li><li><a href=/tags/make.html title=make>make<sup>3</sup></a></li><li><a href=/tags/mud.html title=mud>mud<sup>2</sup></a></li><li><a href=/tags/python.html title=python>python<sup>3</sup></a></li><li><a href=/tags/safeseh.html title=safeseh>safeseh<sup>2</sup></a></li><li><a href=/tags/style.html title=style>style<sup>2</sup></a></li><li><a href=/tags/sudo.html title=sudo>sudo<sup>2</sup></a></li><li><a href=/tags/ubuntu.html title=ubuntu>ubuntu<sup>8</sup></a></li><li><a href=/tags/windows.html title=windows>windows<sup>4</sup></a></li><li><a href=/tags/yum.html title=yum>yum<sup>4</sup></a></li><li><a href=/tags/zlib.html title=zlib>zlib<sup>4</sup></a></li></ul></div></aside><div class=rsspart><a href=/atom.xml class=btn target=_blank title=rss>RSS 订阅</a></div></div></div><footer><div id=footer><div class=line><div class=author></div></div><section class=info><p>Hello, this is leaker's blog in github.<br>Leaker: "Living without an aim is like sailing without a compass."</p></section><div class=social-font class=clearfix><a href=mailto:admin@leelib.com target=_blank class=icon-email title="Email Me"></a></div><p class=copyright>Powered by <a rel=noopener title=Hugo href=https://gohugo.io target=_blank>Hugo</a> and Theme by <a rel=noopener title=Fika href=https://github.com/leaker/hugo-theme-fika target=_blank>Fika</a> © 2022
<a href=/about/index.html target=_blank title=leaker>leaker</a>
<a target=_blank rel="noopener noreferrer" href=http://www.beian.miit.gov.cn/ class=report-link><img rel=nofollow title="备案号： 陕ICP备20006522号" class=report-img src=/images/report-img.webp><span class=report-link-text>陕ICP备20006522号</span></a></p></div></footer></body></html>