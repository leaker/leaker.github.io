<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="Posts"><meta property="og:site_name" content="逃避虽然可耻但有用"><meta property="og:locale" content="zh-CN"><meta property="article:published_time" content="0001-01-01T00:00:00+0000"><meta property="article:modified_time" content="2024-01-10T22:26:31+0800"><title>Posts | 逃避虽然可耻但有用 </title><link rel=alternate type=application/rss+xml href=https://www.leelib.com/posts/atom.xml title=逃避虽然可耻但有用><link rel=stylesheet href=/css/fika.min.5141ca2ae6d63791cb7ebbf2209efeffb8627d834626ff07296f6d342d8db6f5.css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon></head><body><header><div><div id=imglogo><a href=https://www.leelib.com/><img src=/img/logo.webp alt=逃避虽然可耻但有用 title=逃避虽然可耻但有用></a></div><div id=textlogo><h1 class=site-name><a href=/ title=逃避虽然可耻但有用>逃避虽然可耻但有用</a></h1><h2 class=blog-motto>少壮不努力，一生在内地</h2></div><nav class=animated><ul><li><a href=/>主页</a></li><li><a href=/archives/index.html>归档</a></li><li><a href=/about/index.html>关于</a></li><li><a href=/disappear/index.html>消失</a></li></ul></nav></div></header><div id=container><div id=main><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/10/30/fix-winrar-order.html title=解决WinRAR压缩包分卷乱序导致无法解压的问题 itemprop=url>解决WinRAR压缩包分卷乱序导致无法解压的问题</a></h1><p class=article-time><time datetime="2013-10-30 00:24:38 +0800 +0800" itemprop=datePublished>2013-10-30</time></p></header><div class=article-content><p>下载游戏：<strong>《古墓丽影9》中文免安装绿色豪华硬盘版[1.1.732.1升级档][解压即玩]</strong>
光压缩包所有分卷加起来就有快10个G
结果用QQ旋风下载下来后成乱序的了
然后到网站上一看发现QQ旋风本身就把链接那些顺序没搞对。
参考下载地址：<a href=http://fenxiang.qq.com/x/3SSKsVNycfRNc3CJcuCA0~NHIcT5rX133GN0qnvKZltI title=http://fenxiang.qq.com/x/3SSKsVNycfRNc3CJcuCA0~NHIcT5rX133GN0qnvKZltI>Tomb.Raider.9.v1.1.732.1.CHS.Green.Edition</a></p><p>自己根据使用7-zip打开压缩包的“之前分割”和“之后分割”信息拼凑了半天，结果还是有一个文件“bigfile.001.tiger”不能成功解压。最终放弃。</p><p>结果在网上搜索了半天，竟然发现“360压缩”竟然宣称自己可以修复。</p><p>原文在：<a href=http://yasuo.360.cn/update.html title=http://yasuo.360.cn/update.html>http://yasuo.360.cn/update.html</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>1.6正式版（2011-5-26）
</span></span><span style=display:flex><span>  1.智能压缩方式，360压缩支持智能极速、强力压缩、标准压缩等压缩方式。智能压缩根据文件智能选择压缩算法，大幅提升压缩速度。
</span></span><span style=display:flex><span>  2.多种格式支持，支持解压rar、zip、7z、iso等39种格式的压缩文件。
</span></span><span style=display:flex><span>  3.解压速度更快，采用多线程解压处理，优化了解压逻辑，速度更快。
</span></span><span style=display:flex><span>  4.损坏格式兼容，对格式头有损坏的压缩包一样修复解压。
</span></span><span style=display:flex><span>* 5.分卷压缩智能解压，智能判断解压rar分卷包时的文件夹名乱序问题。
</span></span><span style=display:flex><span>  6.更安全的压缩软件，内含360云安全引擎，对压缩包内木马进行检测，更安全。
</span></span><span style=display:flex><span>  7.不断完善的细节体验，支持跳转到桌面、自动消重文件夹等20多处相对传统压缩软件的细节功能改进。
</span></span></code></pre></div><p>抱着尝试的心态，下载了一个最新版的安装上尝试后。发现真的正常解压了所有压缩包。
总算是解决了目前的尴尬问题，所以在此留文提醒有遇到跟我同样问题的朋友。</p><p>成功解压版本：<a href=http://dl.360safe.com/360zip_beta_3.1.0.1071.exe title=360zip_beta_3.1.0.1071>360zip_beta_3.1.0.1071</a></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/summarys.html>Summarys</a></div><div class=article-tags><span></span>
<a href=/tags/360zip.html>360zip</a>
<a href=/tags/disorder.html>Disorder</a>
<a href=/tags/tomb-raider.html>Tomb Raider</a>
<a href=/tags/winrar.html>Winrar</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/10/29/make-socket-proxy.html title=让Socket通过HTTP代理通讯 itemprop=url>让Socket通过HTTP代理通讯</a></h1><p class=article-time><time datetime="2013-10-29 16:06:54 +0800 +0800" itemprop=datePublished>2013-10-29</time></p></header><div class=article-content><h2 id=如果socket想使用http代理需要进行下面步骤>如果socket想使用HTTP代理，需要进行下面步骤：</h2><ol><li>connect到代理服务器</li><li>send(Format(&ldquo;CONNECT %s:%s HTTP/1.1rnUser-Agent: MyApp/0.1rnrn&rdquo;, &lt;真正目标IP>, &lt;真正目标端口>)</li><li>recv 数据，并且根据数据内容判断CONNECT协议是否成功（是否有返回"HTTP/1.1 200"）</li><li>如果第3步成功了，那么这个socket就已经是通过HTTP代理来连接的了，剩下的该怎么发包收包都照旧了</li></ol></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>Programing</a></div><div class=article-tags><span></span>
<a href=/tags/connect.html>Connect</a>
<a href=/tags/http.html>Http</a>
<a href=/tags/proxy.html>Proxy</a>
<a href=/tags/recv.html>Recv</a>
<a href=/tags/socket.html>Socket</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/10/04/use-zlib.html title=自己使用过程中使用zlib链接时出的错误总结 itemprop=url>自己使用过程中使用zlib链接时出的错误总结</a></h1><p class=article-time><time datetime="2013-10-04 06:37:29 +0800 +0800" itemprop=datePublished>2013-10-04</time></p></header><div class=article-content><h1 id=错误1>错误1</h1><p><strong>error LNK2019: unresolved external symbol _deflateEnd@4</strong></p><h2 id=原因1-未使用zlib的链接库>原因1: 未使用zlib的链接库</h2><ul><li>解决：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#pragma comment(lib, &#34;zlibstat.lib&#34;) </span><span style=color:#75715e>// for static lib
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#pragma comment(lib, &#34;zdll.lib&#34;) </span><span style=color:#75715e>// for dll lib
</span></span></span></code></pre></div><h2 id=原因2在使用静态库时即使包含了zlibstatlib没有定义宏zlib_winapi>原因2：在使用静态库时即使包含了zlibstat.lib没有定义宏“ZLIB_WINAPI”</h2><ul><li>解决：
在项目属性中 C/C++ -> Preprocessor -> Preprocessor Definitions 添加“ZLIB_WINAPI”
注意：这个必须在项目中添加，使用#define来添加是无效的。</li></ul><h1 id=错误2>错误2</h1><p><strong>error LNK2026: module unsafe for SAFESEH image</strong></p><h2 id=原因两个项目safeseh设置不同>原因：两个项目SAFESEH设置不同</h2><ul><li>解决：
设置项目属性: Linker -> Advanced -> [Image Has Safe Exception Handlers] = &ldquo;No&rdquo;
<em>注意：这个必须在项目中添加，使用#pragma来添加是无效的。</em></li></ul><h1 id=错误3>错误3</h1><p><strong>error LNK2005: __call_reportfault already defined in LIBCMTD.lib(invarg.obj)或类似其他的error LNK2005:</strong></p><h2 id=原因与libcmt库冲突了>原因：与libcmt库冲突了</h2><ul><li>解决：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#pragma comment(linker, &#34;/NODEFAULTLIB:libcmt.lib&#34;)
</span></span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>Programing</a></div><div class=article-tags><span></span>
<a href=/tags/comment.html>Comment</a>
<a href=/tags/lib.html>Lib</a>
<a href=/tags/link.html>Link</a>
<a href=/tags/lnk2005.html>LNK2005</a>
<a href=/tags/pragma.html>Pragma</a>
<a href=/tags/safeseh.html>SAFESEH</a>
<a href=/tags/static.html>Static</a>
<a href=/tags/zlib.html>Zlib</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/10/03/error-lnk2026-module-unsafe-for-safeseh-image.html title="error LNK2026: module unsafe for SAFESEH image 解决方案" itemprop=url>error LNK2026: module unsafe for SAFESEH image 解决方案</a></h1><p class=article-time><time datetime="2013-10-03 15:21:16 +0800 +0800" itemprop=datePublished>2013-10-03</time></p></header><div class=article-content><h1 id=解决方案>解决方案</h1><p>下面两种随便选一种</p><h2 id=方法1>方法1</h2><p>去掉项目设置中: <strong>Linker -> Advanced -> [Image Has Safe Exception Handlers] = &ldquo;No&rdquo;</strong></p><h2 id=方法2>方法2</h2><p>直接在代码中:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#pragma comment(linker, &#34;/SAFESEH:NO&#34;)
</span></span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>Programing</a></div><div class=article-tags><span></span>
<a href=/tags/advanced.html>Advanced</a>
<a href=/tags/c.html>C</a>
<a href=/tags/error.html>Error</a>
<a href=/tags/image.html>Image</a>
<a href=/tags/linker.html>Linker</a>
<a href=/tags/lnk2026.html>LNK2026</a>
<a href=/tags/module.html>Module</a>
<a href=/tags/safeseh.html>SAFESEH</a>
<a href=/tags/unsafe.html>Unsafe</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/10/03/how-to-use-crt.html title="如何用正确的 C 运行时 (CRT) 库链接" itemprop=url>如何用正确的 C 运行时 (CRT) 库链接</a></h1><p class=article-time><time datetime="2013-10-03 04:13:52 +0800 +0800" itemprop=datePublished>2013-10-03</time></p></header><div class=article-content><h1 id=概要>概要</h1><p>有六种类型的可重用的库：</p><blockquote><p>静态单线程库 （调试/发行版）
静态多线程的库 （调试/发行版）
动态链接库 (DLL)(Debug/Release)
注意每个库都有一个调试版本和发布版本。</p></blockquote><pre><code>Reusable Library            Switch    Library    Macro(s) Defined
--------------------------- --------- ---------- ----------------------
Single Threaded             /ML       LIBC       (none)
Static MultiThread          /MT       LIBCMT     _MT
Dynamic Link (DLL)          /MD       MSVCRT     _MT and _DLL
Debug Single Threaded       /MLd      LIBCD      _DEBUG
Debug Static MultiThread    /MTd      LIBCMTD    _DEBUG and _MT
Debug Dynamic Link (DLL)    /MDd      MSVCRTD    _DEBUG, _MT, and _DLL
</code></pre><h2 id=下面的代码可以使用可重用库的头文件中以确保一致使用正确的编译器开关>下面的代码可以使用可重用库的头文件中以确保一致使用正确的编译器开关：</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// MyReusableStaticSingleThreadReleaseLibrary.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#if defined(_MT) || defined(_DEBUG)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#error The /ML compiler switch is required.
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// MyReusableStaticMultithreadReleaseLibrary.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#if !defined(_MT) || defined(_DLL) || defined(_DEBUG)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#error The /MT compiler switch is required.
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// MyReusableDynamicLinkReleaseLibrary.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#if !defined(_MT) || !defined(_DLL) || defined(_DEBUG)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#error The /MD compiler switch is required.
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// MyReusableStaticSingleThreadDebugLibrary.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#if defined(_MT) || !defined(_DEBUG)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#error The /MLd compiler switch is required.
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// MyReusableStaticMultithreadDebugLibrary.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#if !defined(_MT) || defined(_DLL) || !defined(_DEBUG)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#error The /MTd compiler switch is required.
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// MyReusableDynamicLinkDebugLibrary.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#if !defined(_MT) || !defined(_DLL) || !defined(_DEBUG)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#error The /MDd compiler switch is required.
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span></code></pre></div><p>原文：<a href=http://support.microsoft.com/kb/140584/zh-cn>http://support.microsoft.com/kb/140584/zh-cn</a></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/programing.html>Programing</a></div><div class=article-tags><span></span></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/09/28/modify-ssh-lang.html title=修改连接SSH时的系统语言 itemprop=url>修改连接SSH时的系统语言</a></h1><p class=article-time><time datetime="2013-09-28 05:13:34 +0800 +0800" itemprop=datePublished>2013-09-28</time></p></header><div class=article-content><blockquote><p>在SSH连接后执行下面命令：</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export LANG<span style=color:#f92672>=</span>en_US
</span></span><span style=display:flex><span>export LC_ALL<span style=color:#f92672>=</span>en_US
</span></span></code></pre></div><blockquote><p>不过上面的修改只是临时的，仅这一次连接有效。等到下次再连接的时候，又得重新调用。所以可以采用下面永久解决这个问题：</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#39;LANG=&#34;en_US.UTF-8&#34;  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>LANGUAGE=&#34;en_US:en&#34;&#39;</span> &gt; /etc/default/locale
</span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/summarys.html>Summarys</a></div><div class=article-tags><span></span></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/09/22/ubuntu-install-sublime2-with-src.html title=[摘抄笔记]sublime2在Ubuntu下命令安装以及官网压缩包安装 itemprop=url>[摘抄笔记]sublime2在Ubuntu下命令安装以及官网压缩包安装</a></h1><p class=article-time><time datetime="2013-09-22 07:57:24 +0800 +0800" itemprop=datePublished>2013-09-22</time></p></header><div class=article-content><h1 id=通过终端terminal命令安装>通过终端（terminal）命令安装</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo add-apt-repository ppa:webupd8team/sublime-text-2
</span></span><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span>sudo apt-get install sublime-text
</span></span></code></pre></div><h1 id=通过解压官网安装包安装>通过解压官网安装包安装</h1><ol><li>将下载的tar.bz2文件解压</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tar xf Sublime Text 2.0.1 x64.tar.bz2
</span></span></code></pre></div><ol start=2><li>将解压后的文件夹移动到应用程序文件夹</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo mv Sublime Text <span style=color:#ae81ff>2</span> /opt/
</span></span></code></pre></div><ol start=3><li>设置terminal快速启动命令</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ln -s /opt/Sublime Text 2/sublime_text /usr/bin/sublime
</span></span></code></pre></div><ol start=4><li>在桌面创建快捷方式</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo sublime /usr/share/applications/sublime.desktop
</span></span></code></pre></div><ol start=5><li>将下面的代码保存进去</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Desktop Entry]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Version</span><span style=color:#f92672>=</span><span style=color:#e6db74>1.0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Name</span><span style=color:#f92672>=</span><span style=color:#e6db74>Sublime Text 2</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Only KDE 4 seems to use GenericName, so we reuse the KDE strings.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># From Ubuntu&#39;s language-pack-kde-XX-base packages, version 9.04-20090413.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>GenericName</span><span style=color:#f92672>=</span><span style=color:#e6db74>Text Editor</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Exec</span><span style=color:#f92672>=</span><span style=color:#e6db74>sublime</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Terminal</span><span style=color:#f92672>=</span><span style=color:#e6db74>false</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>/opt/Sublime Text 2/Icon/48x48/sublime_text.webp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>Application</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Categories</span><span style=color:#f92672>=</span><span style=color:#e6db74>TextEditor;IDE;Development</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>X-Ayatana-Desktop-Shortcuts</span><span style=color:#f92672>=</span><span style=color:#e6db74>NewWindow</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[NewWindow Shortcut Group]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Name</span><span style=color:#f92672>=</span><span style=color:#e6db74>New Window</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Exec</span><span style=color:#f92672>=</span><span style=color:#e6db74>sublime -n</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TargetEnvironment</span><span style=color:#f92672>=</span><span style=color:#e6db74>Unity</span>
</span></span></code></pre></div><p>貌似安装sublime3的时候会自动创建快速启动命令，所以如果安装的是3就不用再手动设置了</p><p>摘抄自原文：<a href=http://my.oschina.net/rc6688/blog/162043#OSC_h2_4>http://my.oschina.net/rc6688/blog/162043#OSC_h2_4</a></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>Linux</a></div><div class=article-tags><span></span>
<a href=/tags/kde.html>Kde</a>
<a href=/tags/linux.html>Linux</a>
<a href=/tags/sublime.html>Sublime</a>
<a href=/tags/ubuntu.html>Ubuntu</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/09/07/fix-kernel-devel.html title="解决在安装了kernel-devel后/lib/modules/$(uname -r)/build 链接失效的问题" itemprop=url>解决在安装了kernel-devel后/lib/modules/$(uname -r)/build 链接失效的问题</a></h1><p class=article-time><time datetime="2013-09-07 12:28:20 +0800 +0800" itemprop=datePublished>2013-09-07</time></p></header><div class=article-content><p>如何安装kernel-devel，可以参考我之前的文章：<a href=/2013/06/02/install-kernel-devel.html>《Linux下编译驱动发现没有内核源码的解决办法》</a></p><p>下面是我写的一个自动脚本：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/src/kernels
</span></span><span style=display:flex><span>cd <span style=color:#66d9ef>$(</span>ls -d */ | head -n 1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>ln -s -f <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span> /lib/modules/<span style=color:#66d9ef>$(</span>uname -r<span style=color:#66d9ef>)</span>/build
</span></span></code></pre></div><p>至于为什么要费劲去 *<em>cd $(ls -d <em>/ | head -n 1)</em></em> 的原因是：很多系统装出来的 <strong>kernel-devel</strong> 目录名称跟 <strong>$(uname -r)</strong> 并不一致</p><p>至此这个问题修复完成。</p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>Linux</a></div><div class=article-tags><span></span>
<a href=/tags/build.html>Build</a>
<a href=/tags/kernel-devel.html>Kernel-Devel</a>
<a href=/tags/kernels.html>Kernels</a>
<a href=/tags/ln.html>Ln</a>
<a href=/tags/modules.html>Modules</a>
<a href=/tags/uname.html>Uname</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/09/06/sk-buff-2-6-18-diff-2-6-33.html title=结构体sk_buff在Linux内核2.6.18与2.6.33中的区别 itemprop=url>结构体sk_buff在Linux内核2.6.18与2.6.33中的区别</a></h1><p class=article-time><time datetime="2013-09-06 17:28:58 +0800 +0800" itemprop=datePublished>2013-09-06</time></p></header><div class=article-content><p>在Linux 2.6.33.6中，源文件在：/usr/src/kernels/2.6.33.6/include/linux/skbuff.h</p><h1 id=struct-sk_buff在2618中的定义>struct sk_buff在2.6.18中的定义：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sk_buff {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These two members must be first. */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>prev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sock             <span style=color:#f92672>*</span>sk;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> skb_timeval      tstamp;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> net_device       <span style=color:#f92672>*</span>dev;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> net_device       <span style=color:#f92672>*</span>input_dev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> tcphdr   <span style=color:#f92672>*</span>th;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> udphdr   <span style=color:#f92672>*</span>uh;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> icmphdr  <span style=color:#f92672>*</span>icmph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> igmphdr  <span style=color:#f92672>*</span>igmph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> iphdr    <span style=color:#f92672>*</span>ipiph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> ipv6hdr  <span style=color:#f92672>*</span>ipv6h;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>   <span style=color:#f92672>*</span>raw;
</span></span><span style=display:flex><span>        } h;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> iphdr    <span style=color:#f92672>*</span>iph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> ipv6hdr  <span style=color:#f92672>*</span>ipv6h;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> arphdr   <span style=color:#f92672>*</span>arph;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>   <span style=color:#f92672>*</span>raw;
</span></span><span style=display:flex><span>        } nh;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>   <span style=color:#f92672>*</span>raw;
</span></span><span style=display:flex><span>        } mac;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span>  dst_entry       <span style=color:#f92672>*</span>dst;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span>  sec_path        <span style=color:#f92672>*</span>sp;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * This is the control buffer. It is free to use for every
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * layer. Please put your private variables there. If you
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * want to keep them across layers you have to do a skb_clone()
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * first. This is owned by whoever has the skb queued ATM.
</span></span></span><span style=display:flex><span><span style=color:#75715e>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span>                    cb[<span style=color:#ae81ff>48</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            len,
</span></span><span style=display:flex><span>                                data_len,
</span></span><span style=display:flex><span>                                mac_len,
</span></span><span style=display:flex><span>                                csum;
</span></span><span style=display:flex><span>        __u32                   priority;
</span></span><span style=display:flex><span>        __u8                    local_df:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                cloned:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                ip_summed:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                                nohdr:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                nfctinfo:<span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        __u8                    pkt_type:<span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>                                fclone:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span><span style=color:#75715e>#ifndef CONFIG_XEN
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                ipvs_property:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#else
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                ipvs_property:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                proto_data_valid:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                proto_csum_blank:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __be16                  protocol;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span>                    (<span style=color:#f92672>*</span>destructor)(<span style=color:#66d9ef>struct</span> sk_buff <span style=color:#f92672>*</span>skb);
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NETFILTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_conntrack     <span style=color:#f92672>*</span>nfct;
</span></span><span style=display:flex><span><span style=color:#75715e>#if defined(CONFIG_NF_CONNTRACK) || defined(CONFIG_NF_CONNTRACK_MODULE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>nfct_reasm;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_BRIDGE_NETFILTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_bridge_info   <span style=color:#f92672>*</span>nf_bridge;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u32                   nfmark;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif </span><span style=color:#75715e>/* CONFIG_NETFILTER */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_SCHED
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_index;       <span style=color:#75715e>/* traffic control index */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_CLS_ACT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_verd;        <span style=color:#75715e>/* traffic control verdict */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_DMA
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>dma_cookie_t</span>            dma_cookie;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NETWORK_SECMARK
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u32                   secmark;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These elements must be at the end, see alloc_skb() for details.  */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            truesize;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>atomic_t</span>                users;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>           <span style=color:#f92672>*</span>head,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>data,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>tail,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>end;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* Extra stuff at the end to avoid breaking abi */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifndef __GENKSYMS__
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span>                      peeked;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span></code></pre></div><h1 id=struct-sk_buff在2633中的定义>struct sk_buff在2.6.33中的定义：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sk_buff {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These two members must be first. */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>prev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>ktime_t</span>                 tstamp;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sock             <span style=color:#f92672>*</span>sk;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> net_device       <span style=color:#f92672>*</span>dev;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * This is the control buffer. It is free to use for every
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * layer. Please put your private variables there. If you
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * want to keep them across layers you have to do a skb_clone()
</span></span></span><span style=display:flex><span><span style=color:#75715e>         * first. This is owned by whoever has the skb queued ATM.
</span></span></span><span style=display:flex><span><span style=color:#75715e>         */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span>                    cb[<span style=color:#ae81ff>48</span>] <span style=color:#a6e22e>__aligned</span>(<span style=color:#ae81ff>8</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span>           _skb_dst;
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_XFRM
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span>  sec_path        <span style=color:#f92672>*</span>sp;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            len,
</span></span><span style=display:flex><span>                                data_len;
</span></span><span style=display:flex><span>        __u16                   mac_len,
</span></span><span style=display:flex><span>                                hdr_len;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                __wsum          csum;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>                        __u16   csum_start;
</span></span><span style=display:flex><span>                        __u16   csum_offset;
</span></span><span style=display:flex><span>                };
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        __u32                   priority;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kmemcheck_bitfield_begin</span>(flags1);
</span></span><span style=display:flex><span>        __u8                    local_df:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                cloned:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                ip_summed:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                                nohdr:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                nfctinfo:<span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        __u8                    pkt_type:<span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>                                fclone:<span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                                ipvs_property:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                peeked:<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                nf_trace:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        __be16                  protocol:<span style=color:#ae81ff>16</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kmemcheck_bitfield_end</span>(flags1);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span>                    (<span style=color:#f92672>*</span>destructor)(<span style=color:#66d9ef>struct</span> sk_buff <span style=color:#f92672>*</span>skb);
</span></span><span style=display:flex><span><span style=color:#75715e>#if defined(CONFIG_NF_CONNTRACK) || defined(CONFIG_NF_CONNTRACK_MODULE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_conntrack     <span style=color:#f92672>*</span>nfct;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>struct</span> sk_buff          <span style=color:#f92672>*</span>nfct_reasm;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_BRIDGE_NETFILTER
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>struct</span> nf_bridge_info   <span style=color:#f92672>*</span>nf_bridge;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span>                     skb_iif;
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_SCHED
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_index;       <span style=color:#75715e>/* traffic control index */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_CLS_ACT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u16                   tc_verd;        <span style=color:#75715e>/* traffic control verdict */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kmemcheck_bitfield_begin</span>(flags2);
</span></span><span style=display:flex><span>        __u16                   queue_mapping:<span style=color:#ae81ff>16</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_IPV6_NDISC_NODETYPE
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u8                    ndisc_nodetype:<span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>kmemcheck_bitfield_end</span>(flags2);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* 0/14 bit hole */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NET_DMA
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>dma_cookie_t</span>            dma_cookie;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#ifdef CONFIG_NETWORK_SECMARK
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        __u32                   secmark;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>union</span> {
</span></span><span style=display:flex><span>                __u32           mark;
</span></span><span style=display:flex><span>                __u32           dropcount;
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        __u16                   vlan_tci;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          transport_header;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          network_header;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          mac_header;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* These elements must be at the end, see alloc_skb() for details.  */</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          tail;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>sk_buff_data_t</span>          end;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>           <span style=color:#f92672>*</span>head,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>*</span>data;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>            truesize;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>atomic_t</span>                users;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>有了以上定义的话，我们就可以做类似如下定义来使我们的驱动支持多内核了：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sk_buff <span style=color:#f92672>*</span>new_skb;
</span></span><span style=display:flex><span><span style=color:#75715e>#if LINUX_VERSION_CODE &lt;= KERNEL_VERSION(2,6,18)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>new_skb<span style=color:#f92672>-&gt;</span>mac.raw <span style=color:#f92672>=</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)new_eth_p;
</span></span><span style=display:flex><span><span style=color:#75715e>#else
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>new_skb<span style=color:#f92672>-&gt;</span>mac_header <span style=color:#f92672>=</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)new_eth_p;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span></code></pre></div><p>参考：<a href=http://www.linuxquestions.org/questions/linux-kernel-70/struct-sk_buff-differs-in-2-6-18-and-2-6-33-kernel-882507/>http://www.linuxquestions.org/questions/linux-kernel-70/struct-sk_buff-differs-in-2-6-18-and-2-6-33-kernel-882507/</a></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>Linux</a></div><div class=article-tags><span></span>
<a href=/tags/driver.html>Driver</a>
<a href=/tags/inux_version_code.html>INUX_VERSION_CODE</a>
<a href=/tags/kernel.html>Kernel</a>
<a href=/tags/kernel_version.html>KERNEL_VERSION</a>
<a href=/tags/linux.html>Linux</a>
<a href=/tags/sk_buff.html>Sk_buff</a></div></div></footer></article><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2013/07/26/fix-centos-yum.html title=解决CentOS安装新版本python后，yum不能使用的问题 itemprop=url>解决CentOS安装新版本python后，yum不能使用的问题</a></h1><p class=article-time><time datetime="2013-07-26 02:42:41 +0800 +0800" itemprop=datePublished>2013-07-26</time></p></header><div class=article-content><h1 id=centos-上安装新版本-python>CentOS 上安装新版本 python</h1><p>请看： <a href=/2013/07/10/fix-python-deff-version.html>安装python以及解决版本问题</a></p><p>但在安装新版本后，yum不能正常使用了。原因是yum是基于默认的python版本运行的，例如CentOS6.2基于python2.6。但我们安装版本后建立了链接，覆盖掉了默认python调用，导致yum脚本无法正常调用到自己想要的版本。</p><h1 id=解决方案>解决方案</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim /usr/bin/yum
</span></span></code></pre></div><p>将第一行 <strong>#!/usr/bin/python</strong> 修改成 <strong>#!/usr/bin/python2.6</strong></p></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>Linux</a></div><div class=article-tags><span></span></div></div></footer></article><nav id=page-nav class=clearfix><a class="extend first" aria-label=First rel=first role=button href=/posts.html><span></span>首页</a>
<a class="extend prev" aria-label=Prev rel=prev role=button href=/posts/page/4.html><span></span>上一页</a>
<span>...</span>
<a class=page-number href=/posts/page/2.html aria-label="Page 2" role=button>2</a>
<a class=page-number href=/posts/page/3.html aria-label="Page 3" role=button>3</a>
<a class=page-number href=/posts/page/4.html aria-label="Page 4" role=button>4</a>
<a class="page-number current" aria-label="Page 5" role=button>5</a>
<a class=page-number href=/posts/page/6.html aria-label="Page 6" role=button>6</a>
<a class=page-number href=/posts/page/7.html aria-label="Page 7" role=button>7</a>
<a class=page-number href=/posts/page/8.html aria-label="Page 8" role=button>8</a>
<a class="extend last" aria-label=Last rel=last role=button href=/posts/page/8.html>尾页<span></span></a>
<a class="extend next" aria-label=Next rel=next role=button href=/posts/page/6.html>下一页<span></span></a></nav></div><div id=asidepart><aside class=clearfix><p class=asidetitle>文章分类</p><div class=categorieslist><ul><li><a href=/categories/deploy.html title=deploy><div><span class=count>1</span>
<span class=title>deploy</span></div></a></li><li><a href=/categories/interesting.html title=interesting><div><span class=count>1</span>
<span class=title>interesting</span></div></a></li><li><a href=/categories/linux.html title=linux><div><span class=count>29</span>
<span class=title>linux</span></div></a></li><li><a href=/categories/notices.html title=notices><div><span class=count>6</span>
<span class=title>notices</span></div></a></li><li><a href=/categories/programing.html title=programing><div><span class=count>28</span>
<span class=title>programing</span></div></a></li><li><a href=/categories/sites.html title=sites><div><span class=count>1</span>
<span class=title>sites</span></div></a></li><li><a href=/categories/summarys.html title=summarys><div><span class=count>10</span>
<span class=title>summarys</span></div></a></li><li><a href=/categories/works.html title=works><div><span class=count>2</span>
<span class=title>works</span></div></a></li></ul></div></aside><aside class=clearfix><p class=asidetitle>文章标签</p><div class=tagslist><ul class=clearfix><li><a href=/tags/c.html title=c>c<sup>3</sup></a></li><li><a href=/tags/centos.html title=centos>centos<sup>5</sup></a></li><li><a href=/tags/compress.html title=compress>compress<sup>2</sup></a></li><li><a href=/tags/conf.html title=conf>conf<sup>2</sup></a></li><li><a href=/tags/css.html title=css>css<sup>2</sup></a></li><li><a href=/tags/gcc.html title=gcc>gcc<sup>2</sup></a></li><li><a href=/tags/git.html title=git>git<sup>3</sup></a></li><li><a href=/tags/html.html title=html>html<sup>2</sup></a></li><li><a href=/tags/https.html title=https>https<sup>2</sup></a></li><li><a href=/tags/hugo.html title=hugo>hugo<sup>2</sup></a></li><li><a href=/tags/install.html title=install>install<sup>4</sup></a></li><li><a href=/tags/kernel.html title=kernel>kernel<sup>3</sup></a></li><li><a href=/tags/layout.html title=layout>layout<sup>2</sup></a></li><li><a href=/tags/libc.html title=libc>libc<sup>2</sup></a></li><li><a href=/tags/linux.html title=linux>linux<sup>12</sup></a></li><li><a href=/tags/ln.html title=ln>ln<sup>2</sup></a></li><li><a href=/tags/make.html title=make>make<sup>3</sup></a></li><li><a href=/tags/mud.html title=mud>mud<sup>2</sup></a></li><li><a href=/tags/python.html title=python>python<sup>3</sup></a></li><li><a href=/tags/safeseh.html title=safeseh>safeseh<sup>2</sup></a></li><li><a href=/tags/style.html title=style>style<sup>2</sup></a></li><li><a href=/tags/sudo.html title=sudo>sudo<sup>2</sup></a></li><li><a href=/tags/ubuntu.html title=ubuntu>ubuntu<sup>8</sup></a></li><li><a href=/tags/windows.html title=windows>windows<sup>4</sup></a></li><li><a href=/tags/yum.html title=yum>yum<sup>4</sup></a></li><li><a href=/tags/zlib.html title=zlib>zlib<sup>4</sup></a></li></ul></div></aside><div class=rsspart><a href=/atom.xml class=btn target=_blank title=rss>RSS 订阅</a></div></div></div><footer><div id=footer><div class=line><div class=author></div></div><section class=info><p>Hello, this is leaker's blog in github.<br>Leaker: "Living without an aim is like sailing without a compass."</p></section><div class=social-font class=clearfix><a href=mailto:admin@leelib.com target=_blank class=icon-email title="Email Me"></a></div><p class=copyright>Powered by <a rel=noopener title=Hugo href=https://gohugo.io target=_blank>Hugo</a> and Theme by <a rel=noopener title=Fika href=https://github.com/leaker/hugo-theme-fika target=_blank>Fika</a> © 2022
<a href=/about/index.html target=_blank title=leaker>leaker</a></p></div></footer></body></html>