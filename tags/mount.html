<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="Mount"><meta property="og:site_name" content="逃避虽然可耻但有用"><meta property="og:locale" content="zh-CN"><meta property="article:published_time" content="0001-01-01T00:00:00+0000"><meta property="article:modified_time" content="2020-04-30T20:32:27+0800"><title>Mount | 逃避虽然可耻但有用 </title><link rel=alternate type=application/rss+xml href=https://www.leelib.com/tags/mount/atom.xml title=逃避虽然可耻但有用><link rel=stylesheet href=/css/fika.min.5141ca2ae6d63791cb7ebbf2209efeffb8627d834626ff07296f6d342d8db6f5.css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon></head><body><header><div><div id=imglogo><a href=https://www.leelib.com/><img src=/img/logo.webp alt=逃避虽然可耻但有用 title=逃避虽然可耻但有用></a></div><div id=textlogo><h1 class=site-name><a href=/ title=逃避虽然可耻但有用>逃避虽然可耻但有用</a></h1><h2 class=blog-motto>少壮不努力，一生在内地</h2></div><nav class=animated><ul><li><a href=/>主页</a></li><li><a href=/archives/index.html>归档</a></li><li><a href=/about/index.html>关于</a></li><li><a href=/disappear/index.html>消失</a></li></ul></nav></div></header><div id=container><div id=main><article class="post-expand post" itemprop=articleBody><header class="article-info clearfix"><h1 itemprop=name><a href=/2020/04/30/wsl-ntfs.html title=解决WSL中使用NTFS分区的权限问题 itemprop=url>解决WSL中使用NTFS分区的权限问题</a></h1><p class=article-time><time datetime="2020-04-30 20:32:27 +0800 +0800" itemprop=datePublished>2020-04-30</time></p></header><div class=article-content><p>当使用WSL的过程中访问WSL系统以外目录时候出现一些奇奇怪怪问题
通常就是WSL对于NTFS分区的目录权限问题。</p><p>使用 <strong>mount -l</strong> 查看，可能长这样</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@wsl<span style=color:#f92672>]</span> mount -l
</span></span><span style=display:flex><span>rootfs on / type lxfs <span style=color:#f92672>(</span>rw,noatime<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>none on /dev type tmpfs <span style=color:#f92672>(</span>rw,noatime,mode<span style=color:#f92672>=</span>755<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>sysfs on /sys type sysfs <span style=color:#f92672>(</span>rw,nosuid,nodev,noexec,noatime<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>proc on /proc type proc <span style=color:#f92672>(</span>rw,nosuid,nodev,noexec,noatime<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>devpts on /dev/pts type devpts <span style=color:#f92672>(</span>rw,nosuid,noexec,noatime,gid<span style=color:#f92672>=</span>5,mode<span style=color:#f92672>=</span>620<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>none on /run type tmpfs <span style=color:#f92672>(</span>rw,nosuid,noexec,noatime,mode<span style=color:#f92672>=</span>755<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>none on /run/lock type tmpfs <span style=color:#f92672>(</span>rw,nosuid,nodev,noexec,noatime<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>none on /run/shm type tmpfs <span style=color:#f92672>(</span>rw,nosuid,nodev,noatime<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>none on /run/user type tmpfs <span style=color:#f92672>(</span>rw,nosuid,nodev,noexec,noatime,mode<span style=color:#f92672>=</span>755<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>binfmt_misc on /proc/sys/fs/binfmt_misc type binfmt_misc <span style=color:#f92672>(</span>rw,relatime<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>cgroup on /sys/fs/cgroup type tmpfs <span style=color:#f92672>(</span>rw,relatime,mode<span style=color:#f92672>=</span>755<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>cgroup on /sys/fs/cgroup/devices type cgroup <span style=color:#f92672>(</span>rw,relatime,devices<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\ </span>on /mnt/c type drvfs <span style=color:#f92672>(</span>rw,noatime,uid<span style=color:#f92672>=</span>0,gid<span style=color:#f92672>=</span>0,case<span style=color:#f92672>=</span>off<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>D:<span style=color:#ae81ff>\ </span>on /mnt/d type drvfs <span style=color:#f92672>(</span>rw,noatime,uid<span style=color:#f92672>=</span>0,gid<span style=color:#f92672>=</span>0,case<span style=color:#f92672>=</span>off<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>可以看到 <strong>C:\</strong> 和 <strong>D:\</strong> 加载状况是这样的。这种情况下代表所有目录均以<strong>root</strong>权限进行访问。在使用<strong>ssh</strong>或<strong>git</strong>等工具的时候有可能会因为一些权限问题导致意外情况发生。</p><h3 id=解决办法很简单通过drvfs让wsl可以支持ntfs分区增加文件metadata信息>解决办法很简单，通过DrvFs让WSL可以支持NTFS分区增加文件metadata信息：</h3><ol><li>挂载配置</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#39;[automount]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>enabled = true
</span></span></span><span style=display:flex><span><span style=color:#e6db74>root = /mnt/
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options = &#34;metadata,umask=22,fmask=11&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>mountFsTab = false&#39;</span> &gt; /etc/wsl.conf
</span></span></code></pre></div><ol start=2><li>在<strong>PowerShell</strong>中重启WSL服务</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Restart-Service LxssManager
</span></span></code></pre></div></div><footer class="article-footer clearfix"><div class=article-catetags><div class=article-categories><span></span>
<a class=article-category-link href=/categories/linux.html>Linux</a></div><div class=article-tags><span></span>
<a href=/tags/mount.html>Mount</a>
<a href=/tags/linux.html>Linux</a>
<a href=/tags/wsl.html>Wsl</a>
<a href=/tags/conf.html>Conf</a>
<a href=/tags/powershell.html>Powershell</a>
<a href=/tags/lxss.html>Lxss</a>
<a href=/tags/drvfs.html>Drvfs</a></div></div></footer></article><nav id=page-nav class=clearfix><a class="page-number current" aria-label="Page 1" role=button>1</a></nav></div><div id=asidepart><aside class=clearfix><p class=asidetitle>文章分类</p><div class=categorieslist><ul><li><a href=/categories/deploy.html title=deploy><div><span class=count>1</span>
<span class=title>deploy</span></div></a></li><li><a href=/categories/interesting.html title=interesting><div><span class=count>1</span>
<span class=title>interesting</span></div></a></li><li><a href=/categories/linux.html title=linux><div><span class=count>29</span>
<span class=title>linux</span></div></a></li><li><a href=/categories/notices.html title=notices><div><span class=count>6</span>
<span class=title>notices</span></div></a></li><li><a href=/categories/programing.html title=programing><div><span class=count>28</span>
<span class=title>programing</span></div></a></li><li><a href=/categories/sites.html title=sites><div><span class=count>1</span>
<span class=title>sites</span></div></a></li><li><a href=/categories/summarys.html title=summarys><div><span class=count>10</span>
<span class=title>summarys</span></div></a></li><li><a href=/categories/works.html title=works><div><span class=count>2</span>
<span class=title>works</span></div></a></li></ul></div></aside><aside class=clearfix><p class=asidetitle>文章标签</p><div class=tagslist><ul class=clearfix><li><a href=/tags/c.html title=c>c<sup>3</sup></a></li><li><a href=/tags/centos.html title=centos>centos<sup>5</sup></a></li><li><a href=/tags/compress.html title=compress>compress<sup>2</sup></a></li><li><a href=/tags/conf.html title=conf>conf<sup>2</sup></a></li><li><a href=/tags/css.html title=css>css<sup>2</sup></a></li><li><a href=/tags/gcc.html title=gcc>gcc<sup>2</sup></a></li><li><a href=/tags/git.html title=git>git<sup>3</sup></a></li><li><a href=/tags/html.html title=html>html<sup>2</sup></a></li><li><a href=/tags/https.html title=https>https<sup>2</sup></a></li><li><a href=/tags/hugo.html title=hugo>hugo<sup>2</sup></a></li><li><a href=/tags/install.html title=install>install<sup>4</sup></a></li><li><a href=/tags/kernel.html title=kernel>kernel<sup>3</sup></a></li><li><a href=/tags/layout.html title=layout>layout<sup>2</sup></a></li><li><a href=/tags/libc.html title=libc>libc<sup>2</sup></a></li><li><a href=/tags/linux.html title=linux>linux<sup>12</sup></a></li><li><a href=/tags/ln.html title=ln>ln<sup>2</sup></a></li><li><a href=/tags/make.html title=make>make<sup>3</sup></a></li><li><a href=/tags/mud.html title=mud>mud<sup>2</sup></a></li><li><a href=/tags/python.html title=python>python<sup>3</sup></a></li><li><a href=/tags/safeseh.html title=safeseh>safeseh<sup>2</sup></a></li><li><a href=/tags/style.html title=style>style<sup>2</sup></a></li><li><a href=/tags/sudo.html title=sudo>sudo<sup>2</sup></a></li><li><a href=/tags/ubuntu.html title=ubuntu>ubuntu<sup>8</sup></a></li><li><a href=/tags/windows.html title=windows>windows<sup>4</sup></a></li><li><a href=/tags/yum.html title=yum>yum<sup>4</sup></a></li><li><a href=/tags/zlib.html title=zlib>zlib<sup>4</sup></a></li></ul></div></aside><div class=rsspart><a href=/atom.xml class=btn target=_blank title=rss>RSS 订阅</a></div></div></div><footer><div id=footer><div class=line><div class=author></div></div><section class=info><p>Hello, this is leaker's blog in github.<br>Leaker: "Living without an aim is like sailing without a compass."</p></section><div class=social-font class=clearfix><a href=mailto:admin@leelib.com target=_blank class=icon-email title="Email Me"></a></div><p class=copyright>Powered by <a rel=noopener title=Hugo href=https://gohugo.io target=_blank>Hugo</a> and Theme by <a rel=noopener title=Fika href=https://github.com/leaker/hugo-theme-fika target=_blank>Fika</a> © 2022
<a href=/about/index.html target=_blank title=leaker>leaker</a></p></div></footer></body></html>